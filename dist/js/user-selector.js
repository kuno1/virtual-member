!function(){"use strict";var e=window.ReactJSXRuntime;const{useState:n,useEffect:o}=wp.element,{FormTokenField:s,Button:t,Icon:r,ComboboxControl:a}=wp.components,{apiFetch:c}=wp,l=({user:n,onUserDelete:o})=>(0,e.jsxs)(t,{className:"kvm-user-token",onClick:()=>o(n),iconPosition:"right",variant:"secondary",children:[n.name,(0,e.jsxs)("small",{children:["(",n.group.length>0?n.group.map((e=>e.name)).join(", "):"---",")"]}),(0,e.jsx)(r,{icon:"no-alt"})]}),i=({onUserSelected:s})=>{const[t,r]=n(""),[l,i]=n([]),[m,u]=n(null),[d,h]=n(null);return o((()=>{d&&clearTimeout(d),h(setTimeout((()=>{if(t){const e=async()=>{const e=await c({path:`/kvm/v1/authors/search?s=${t}`});i(e)};try{e()}catch(e){i([])}}else i([])}),300))}),[t]),(0,e.jsx)(a,{label:KvmUserSelector.slabel,placeholder:KvmUserSelector.search,value:m,options:l.map((e=>({label:e.name,value:e.id}))),onChange:e=>{l.forEach((n=>{n.id===e&&s(n)})),u("")},onFilterValueChange:e=>r(e)})},m=window.kvm||{};m.UserSelectorComponent=({post:s,onUserChange:t})=>{const[r,a]=n([]);return o((()=>{(async()=>{try{const e=await c({path:`/kvm/v1/authors/of/${s}`});a(e)}catch(e){alert(e.message||"Error")}})()}),[]),o((()=>{t(r)}),[r]),(0,e.jsxs)(e.Fragment,{children:[r.length>0?(0,e.jsx)("div",{className:"kvm-user-token-wrapper",children:r.map((n=>(0,e.jsx)(l,{user:n,onUserDelete:e=>(e=>{const n=[];r.map((o=>{o.id!==e.id&&n.push(o)})),a(n)})(e)},n.id)))}):(0,e.jsx)("div",{className:"notice notice-error notice-alt",children:(0,e.jsx)("p",{children:KvmUserSelector.nouser})}),(0,e.jsx)(i,{onUserSelected:e=>{r.map((e=>e.id)).includes(e.id)||a(r.concat([e]))}})]})},window.kvm=m}();